
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Gualtiero Testa">
      
      
        <link rel="canonical" href="https://gualtierotesta.github.io/blog/security/web-security/">
      
      
      
      
      <link rel="icon" href="../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Web security - Sharing developer experiences</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-Z08MZGHK67"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-Z08MZGHK67",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-Z08MZGHK67",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#web-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Sharing developer experiences" class="md-header__button md-logo" aria-label="Sharing developer experiences" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sharing developer experiences
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Web security
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Sharing developer experiences" class="md-nav__button md-logo" aria-label="Sharing developer experiences" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Sharing developer experiences
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About me
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Articles
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Books reviews
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../certifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certifications
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../languages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Languages
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodologies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methodologies
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my-books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    My books
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-codes" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP codes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sop-origin" class="md-nav__link">
    <span class="md-ellipsis">
      SOP, ORIGIN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookie" class="md-nav__link">
    <span class="md-ellipsis">
      COOKIE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csrf-cross-site-request-forgery-and-samesite-cookie-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      CSRF (Cross-Site Request Forgery) and SameSite cookie attribute
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cors" class="md-nav__link">
    <span class="md-ellipsis">
      CORS
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <span class="md-tag">authentication</span>
      
    
      
      
      
        <span class="md-tag">authorization</span>
      
    
      
      
      
        <span class="md-tag">security</span>
      
    
      
      
      
        <span class="md-tag">software</span>
      
    
      
      
      
        <span class="md-tag">web</span>
      
    
  </nav>



<h1 id="web-security">Web security</h1>
<p><em>Last update: 01 Aug 2023</em></p>
<h2 id="references">References</h2>
<ol>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security">Web security by MDN</a></li>
<li><a href="https://web.dev/secure/">Web security by the Chrome team</a></li>
<li><a href="https://en.wikipedia.org/wiki/Information_security">Information security on Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">Principle of least privilege</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>Web security is the intersection of the following:</p>
<ul>
<li>Network security --&gt; TLS, firewall, load-balancer</li>
<li>Information security (InfoSec): how we handle the data -&gt; cryptography, access control...</li>
<li>Application security (AppSec): how we use the applications --&gt; vulnerability, credentials storage...</li>
</ul>
<p>Security-related tools:</p>
<ul>
<li>WAF, Web Application Firewall, HTTP level firewalls</li>
<li>IDS, Intrusion Detection System</li>
<li>IPS, Intrusion Prevention System</li>
<li>HSH, Hardware Security Module</li>
</ul>
<p>The security goals are non-functional requirements (NFR) for all applications.</p>
<p>Information security's (see reference 3) primary focus is data <em>Confidentiality</em>, <em>Integrity</em> and <em>Availability</em> (the CIA triad).</p>
<p><a href="https://en.wikipedia.org/wiki/STRIDE_(security)">STRIDE</a> is a security model which describes the possible threads.</p>
<ul>
<li>Spoofing: when a person or a program assumes another person's identity</li>
<li>Tampering: changing data and messages</li>
<li>Repudiation: when someone disputes to be the author or an action</li>
<li>Information disclosure (data leak, privacy breach): acquiring and publishing private info</li>
<li>Denial of service (DoS)</li>
<li>elevation of privilege</li>
</ul>
<h2 id="http-codes">HTTP codes</h2>
<p>Security-related HTTP answers:</p>
<ul>
<li><strong>401</strong> User is not authenticated.</li>
<li><strong>403</strong> The user is not allowed to perform the requested operation, even if they are authenticated.</li>
</ul>
<h2 id="sop-origin">SOP, ORIGIN</h2>
<p>ORIGIN: in any URL, the origin is the union of the protocol, the server and the port (if specified). For example the origin in the URL https://www.example.com/pages/index.html is https://www.example.com. (port is 443 here).</p>
<p>The same-origin policy (SOP) is a critical security mechanism that restricts how a document or script loaded from one origin can interact with a resource from another origin. It helps isolate potentially malicious documents, reducing possible attack vectors.</p>
<p>SOP usually block read calls while writing calls (for ex. form submits) are usually allowed.</p>
<p>For more details <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">MDN on SOP</a></p>
<h2 id="cookie">COOKIE</h2>
<p>Cookie contents:</p>
<ul>
<li><code>path</code> = "/" is the path used by the browser to establish if the cookie should be sent to the server or not depending on the current page</li>
<li><code>expiration</code> (expires and max-age) = cookie expiration date. If not specified, the cookie is a session cookie and it is deleted by the browser at the end of the session. If specified, the cookie is persistent. If the date is in the past, the cookie is deleted.</li>
<li><code>attributes</code> = Secure (send only on HTTPS),  HttpOnly (not readable from JS code), SameSite</li>
<li><code>Domain</code>: the domain of the cookie. If not specified, the cookie is "host-only"</li>
<li><code>name</code> = the name of the cookie</li>
</ul>
<p>The suggested cookies attributes:</p>
<ul>
<li>Session cookie: HttpOnly, Secure, Path=/</li>
<li>CSRF token cookie: Secure, SameSite=strict, Path=/</li>
</ul>
<h2 id="csrf-cross-site-request-forgery-and-samesite-cookie-attribute">CSRF (Cross-Site Request Forgery) and SameSite cookie attribute</h2>
<p>Cross-site Request Forgery (CSRF) is a web attack where actions are performed using the user's identity without them knowing what is happening.</p>
<p>See <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">Wikipedia</a> for more details.</p>
<p>The user is logged in the website A and opens a new browser tab on Website B (the attacker). Website B calls website A back-end services; the browser sends the session cookie to the website A back-end which accepts the request. Even if the browser implements the same-origin policy, still many requests can be done from website B pages to website A server. </p>
<p>The first defence line is to not have GET endpoints that perform create or update or delete actions. Use POST, UPDATE or DELETE methods as appropriate.</p>
<p>The second defence line is to use the <code>SameSite</code> attribute for the session cookie; when set, the browser will not send the cookie if the page does not have the same site (domain) as the cookie.</p>
<p>The SameSite attribute can have the following values:</p>
<ul>
<li>strict: the cookie is not sent in all cross-site requests</li>
<li>lax: the cookie is sent on navigation requests only</li>
<li>none: the cookie is always sent</li>
</ul>
<p>Alternative to the SameSite attribute is the <code>double-submit cookie</code> mechanism. At the first request, the server creates a special CSRF token cookie with a value that the client (the page) should include at every request using the X-CSRF-Token header. The server compares the value with the one that has been generated and allows the request accordingly.</p>
<h2 id="cors">CORS</h2>
<p>Cross-Origin Resource Sharing (CORS) is a security mechanism that allows websites and APIs to control and overcome the same origin policy implemented by the browser.</p>
<p>See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">MDN</a> for more details.</p>
<p>The browser performs a pre-flight request, using the HTTP method OPTIONS, to evaluate if the cross-origin request is possible or not. </p>
<p>The pre-flight response from the server includes several CORS headers:</p>
<div class="highlight"><pre><span></span><code>Access-Control-Allow-Origin
Access-Control-Allow-Headers
Access-Control-Allow-Methods
Access-Control-Allow-Credentials (should be true if we use session cookies)
Access-Control-Max-Age
Access-Control-Expose-Headers
</code></pre></div>
<p>The pre-flight response status code can be:</p>
<ul>
<li>403: the request cannot be performed because not allowed by the resource server</li>
<li>204 (no-contents): the request can be done</li>
</ul>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "content.tabs.link", "content.code.annotate", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>